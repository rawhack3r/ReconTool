from core.error_handler import ErrorHandler

class VulnerabilityScanner:
    def map_to_owasp_top_10(self, vuln_type):
        mapping = {
            'xss': 'A07:2021 - Cross-Site Scripting (XSS)',
            'sqli': 'A03:2021 - Injection',
            'lfi': 'A01:2021 - Broken Access Control',
            'ssrf': 'A10:2021 - Server-Side Request Forgery',
            'open-redirect': 'A03:2021 - Injection',
            'crlf': 'A03:2021 - Injection',
            'ssti': 'A03:2021 - Injection',
            'broken-auth': 'A02:2021 - Broken Authentication',
            'insecure-deserialization': 'A08:2021 - Insecure Deserialization',
            'xml-external-entity': 'A04:2021 - XML External Entities (XXE)',
            'misconfiguration': 'A05:2021 - Security Misconfiguration',
            'vuln-components': 'A06:2021 - Vulnerable and Outdated Components'
        }
        return mapping.get(vuln_type.lower(), 'Unknown')