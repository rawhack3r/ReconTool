from tools.base_tool import BaseTool
import asyncio, json

class HttpxScanner(BaseTool):
    name = "httpx"
    async def scan(self, target):
        cmd = ["httpx","-u",target,"-json"]
        proc = await asyncio.create_subprocess_exec(*cmd, stdout=asyncio.subprocess.PIPE)
        results = []
        async for line in proc.stdout:
            try: obj = json.loads(line.decode()); results.append(obj)
            except Exception: continue
        await proc.wait()
        return results
