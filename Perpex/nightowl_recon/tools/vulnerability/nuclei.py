from tools.base_tool import BaseTool
import asyncio, json

class NucleiScanner(BaseTool):
    name = "nuclei"

    async def scan(self, target):
        cmd = ["nuclei", "-u", target, "-json"]
        proc = await asyncio.create_subprocess_exec(*cmd, stdout=asyncio.subprocess.PIPE)
        results = []
        async for line in proc.stdout:
            try:
                vuln = json.loads(line.decode())
                results.append(vuln)
            except Exception:
                continue
        await proc.wait()
        return results
