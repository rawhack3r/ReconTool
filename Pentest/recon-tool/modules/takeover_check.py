import asyncio
from modules.utils import run_cmd
from rich.console import Console

console = Console()

async def run_takeover_check(alive_file, output_dir):
    console.rule("[bold blue]Subdomain Takeover Check[/bold blue]")
    takeover_file = os.path.join(output_dir, "takeovers.txt")
    cmd = f"subjack -w {alive_file} -t 100 -timeout 30 -o {takeover_file} -ssl"
    await run_cmd(cmd)
    console.print(f"[green]Takeover results saved to {takeover_file}[/green]")
    return takeover_file
