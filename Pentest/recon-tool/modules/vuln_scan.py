import asyncio
from modules.utils import run_cmd
from rich.console import Console

console = Console()

async def run_vuln_scan(alive_file, output_dir):
    console.rule("[bold blue]Vulnerability Scanning[/bold blue]")
    nuclei_file = os.path.join(output_dir, "nuclei_results.txt")
    await run_cmd(f"nuclei -l {alive_file} -o {nuclei_file}")
    console.print(f"[green]Nuclei scan results saved to {nuclei_file}[/green]")
