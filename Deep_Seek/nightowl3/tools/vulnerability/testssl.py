import subprocess
import os

def run(urls, output_dir):
    if not urls:
        return []
    
    output_file = os.path.join(output_dir, "testssl.txt")
    cmd = f"testssl.sh --html {output_dir}/testssl.html {urls[0]} > {output_file}"
    
    try:
        subprocess.run(cmd, shell=True, timeout=3600)
        return ["TestSSL completed"]
    except:
        return []