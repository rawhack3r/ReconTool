import requests

def run(subdomains, output_dir):
    vulnerable = []
    for subdomain in subdomains:
        try:
            response = requests.get(f"http://{subdomain}", timeout=3)
            # Check for known takeover patterns
            if "github.io" in response.text and "404" in response.text:
                vulnerable.append(f"GitHub Pages: {subdomain}")
            elif "azurewebsites.net" in response.text and "404" in response.text:
                vulnerable.append(f"Azure: {subdomain}")
        except:
            continue
    
    with open(os.path.join(output_dir, "takeover.txt"), "w") as f:
        f.write("\n".join(vulnerable))
    
    return vulnerable