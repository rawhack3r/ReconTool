from core.utils import NightOwlUtils

utils = NightOwlUtils()

def run_zap(target, output_dir, state, verbose=False):
    if not state.get("live_urls"):
        return []
    
    output_file = f"{output_dir}/vulns/zap.json"
    cmd = f"zap-cli --zap-path /usr/share/zap -p 8090 quick-scan -o json -O {output_file} "
    cmd += " ".join(state["live_urls"])
    return utils.run_command(cmd, verbose=verbose, output_file=output_file)