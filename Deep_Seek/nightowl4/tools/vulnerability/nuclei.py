from core.utils import NightOwlUtils

utils = NightOwlUtils()

def run_nuclei(target, output_dir, state, verbose=False):
    if not state.get("live_urls"):
        return []
    
    input_file = f"{output_dir}/live_hosts/urls.txt"
    with open(input_file, "w") as f:
        f.write("\n".join(state["live_urls"]))
    
    output_file = f"{output_dir}/vulns/nuclei.txt"
    cmd = f"nuclei -l {input_file} -severity medium,high,critical -o {output_file}"
    return utils.run_command(cmd, verbose=verbose, output_file=output_file)